##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##

#--------------------------------------------------------------------------------------------------------#
#   LOAD PACKAGES AND CODE FOR ANALYSIS                                                                  #
#--------------------------------------------------------------------------------------------------------#
library(tidyverse) ## for function "alpha(col, a)"
library(tikzDevice)
library(stringr)   ## required for str_pad()
source("/home/nikolas/Documents/NPV/njjn_analysis/npv_analysis_jan_2023/npv.R")
source("/home/nikolas/Documents/NPV/njjn_analysis/GRADIENT_FLOW/mixing_probe_src_oet_GRADFLOW/GRADFLOW_ANALYSIS/R_Code/mixing_probe_gf.R")

#--------------------------------------------------------------------------------------------------------#
#                                                                                                        #
#   LOAD WORKSPACE IMAGE                                                                                 #
#                                                                                                        #
#      * containing the cf ratio ratio_1_g5 = Im(<X1g5>) / Re(<Xmx_g5>)                                  #
#      * containing the cf ratio ratio_2_g5 = Im(<X2g5>) / Re(<Xmx_g5>)                                  #
#      * containing the cf ratio ratio_3_g5 = Im(<X3g5mulmin1>) / Re(<Xmx_g5>)                           #
#                                                                                                        #
#      * containing the cf ratio ratio_4_id = Re(<X1idmulmin1>) / Re(<Xmx_id_mulmin1>)                   #
#      * containing the cf ratio ratio_5_id = Re(<X2idmulmin1>) / Re(<Xmx_id_mulmin1>)                   #
#      * containing the cf ratio ratio_6_id = Re(<X3id>) / Re(<Xmx_id_mulmin1>)                          #
#                                                                                                        #
#--------------------------------------------------------------------------------------------------------#
my_data_path <- "/home/nikolas/Documents/NPV/njjn_analysis/GRADIENT_FLOW/mixing_probe_src_oet_GRADFLOW/GRADFLOW_ANALYSIS/04_bootstrap_notimedilution_NLoopsamples8_symm/01_boot_cf_data/NLoopsamples_01/01_boot_cf_data_Nconfs563/bootstrap_cf_mx_prb_oet_gf_notimedilution_Nconfs563_Nsamples1.RData"
load(my_data_path)

#--------------------------------------------------------------------------------------------------------#
#   SET PLOTTING PARAMETERS                                                                              #
#--------------------------------------------------------------------------------------------------------#
Nconfs <- length(my_confs)
Nsrcs <- 1
Nsamples <- 1


##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##

#------------------------------------------------------#
# ratio_2_g5_no2ptflow <- ratio_cf( cf2pt=Xmx_g5,      #
#                                   cf3pt=X2g5,        #
#                                   gamma_mix="g5",    #
#                                   T=my_T,            #
#                                   conflist=my_confs, #
#                                   gradflow_t=my_gft, #
#                                   flow_c2pt=FALSE,   #
#                                   symm=TRUE )        #
#------------------------------------------------------#

##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##

for ( i in 1:length(my_gft) ) {

  AIC_fit( Rdata=ratio_2_g5_no2ptflow[[i]],
           gradflow_t=my_gft[i],
           filename=paste0("fit_cf_ratio_2_vvcc_g5_gft", my_gft[i], "_Nsamples1_no2ptflow"),
           x_lab="$\\langle O_{vv}^{cc}\\, O_{\\gamma_5}\\rangle (t_\\mathrm{gf}) / \\langle O_{\\gamma_5}\\, O_{\\gamma_5} \\rangle (0)$",
           t_i=0, t_f=22, tl_1=1, tl_2=21, tu_1=0, tu_2=22 )
}




