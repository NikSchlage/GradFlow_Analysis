##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##

#--------------------------------------------------------------------------------------------------------#
#   LOAD PACKAGES AND CODE FOR ANALYSIS                                                                  #
#--------------------------------------------------------------------------------------------------------#
library(tidyverse) ## for function "alpha(col, a)"
library(tikzDevice)
library(stringr)   ## required for str_pad()
source("/home/nikolas/Documents/NPV/njjn_analysis/npv_analysis_jan_2023/npv.R")
source("/home/nikolas/Documents/NPV/njjn_analysis/GRADIENT_FLOW/mixing_probe_src_oet_GRADFLOW/GRADFLOW_ANALYSIS/R_Code/mixing_probe_gf.R")

#--------------------------------------------------------------------------------------------------------#
#                                                                                                        #
#   LOAD WORKSPACE IMAGE                                                                                 #
#                                                                                                        #
#      * containing the cf ratio ratio_1_g5 = Im(<X1g5>) / Re(<Xmx_g5>)                                  #
#      * containing the cf ratio ratio_2_g5 = Im(<X2g5>) / Re(<Xmx_g5>)                                  #
#      * containing the cf ratio ratio_3_g5 = Im(<X3g5mulmin1>) / Re(<Xmx_g5>)                           #
#                                                                                                        #
#      * containing the cf ratio ratio_4_id = Re(<X1idmulmin1>) / Re(<Xmx_id_mulmin1>)                   #
#      * containing the cf ratio ratio_5_id = Re(<X2idmulmin1>) / Re(<Xmx_id_mulmin1>)                   #
#      * containing the cf ratio ratio_6_id = Re(<X3id>) / Re(<Xmx_id_mulmin1>)                          #
#                                                                                                        #
#--------------------------------------------------------------------------------------------------------#
my_data_path <- "/home/nikolas/Documents/NPV/njjn_analysis/GRADIENT_FLOW/mixing_probe_src_oet_GRADFLOW/GRADFLOW_ANALYSIS/05_bootstrap_notimedilution_Nconfs1126_symm/01_boot_cf_data/NLoopsamples_01/01_boot_cf_data_Nconfs1126_4qFlavorChange/bootstrap_cf_mx_prb_oet_gf_notimedilution_Nconfs1126_Nsamples1_4qFlavorChange_part3.RData"
load(my_data_path)

#--------------------------------------------------------------------------------------------------------#
#   SET PLOTTING PARAMETERS                                                                              #
#--------------------------------------------------------------------------------------------------------#
Nconfs <- length(my_confs)
Nsrcs <- 1
Nsamples <- 1


##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##

for ( i in 1:length(my_gft) ) {

  AIC_fit( Rdata=ratio_6_id_ud_du_no2ptflow[[i]],
           gradflow_t=my_gft[i],
           filename=paste0("fit_cf_ratio6_aaqb_id_ud_du_gft", my_gft[i], "_Nsamples1_no2ptflow"),
           #x_lab="$\\langle O_{aa}^{qb}\\, O_\\mathbb{1}\\rangle_{ud+du} (t_\\mathrm{gf}) / \\langle O_\\mathbb{1} \\, O_\\mathbb{1}\\rangle_{ud+du} (0)$" )
           x_lab="$\\frac{1}{2}\\langle O_{aa}^{qb}\\, O_{1}\\rangle_{ud+du} (t_\\mathrm{gf}) / \\langle O_{1} \\, O_{1}\\rangle_{ud+du} (0)$",
           t_i=2, t_f=8, tl_1=2, tl_2=8, tu_1=2, tu_2=8 )
}




