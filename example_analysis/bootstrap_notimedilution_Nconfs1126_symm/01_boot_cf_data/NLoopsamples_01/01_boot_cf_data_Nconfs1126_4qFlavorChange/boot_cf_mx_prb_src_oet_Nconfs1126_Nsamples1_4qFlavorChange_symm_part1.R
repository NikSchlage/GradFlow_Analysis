##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##

#--------------------------------------------------------------------------------------------------------#
#   LOAD PACKAGES AND CODE FOR ANALYSIS                                                                  #
#--------------------------------------------------------------------------------------------------------#
library(stringr)   ## required for str_pad()
library(abind)     ## required for "abind()" within "c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys()"
source("/home/nikolas/Documents/NPV/njjn_analysis/npv_analysis_jan_2023/npv.R")
source("../../../../R_Code/mixing_probe_gf.R")   ## load R functions required for this bootstrap analysis

#--------------------------------------------------------------------------------------------------------#
#   SET BOOTSTRAP PARAMETERS                                                                             #
#--------------------------------------------------------------------------------------------------------#
## bootstrapping parameters:
boot.R <- 400
boot.l <- 2   ## block length
seed <- 1234

##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##

#========================================================================================================#
#                                                                                                        #
#   BOOTSTRAP FOR ANALYSIS:                                                                              #
#                                                                                                        #
#   * Bootstrap flavor-conserving c2pt data for keys "f0-[...]-f0-[...]"                                 #
#        - Read c2pt data files in h5 format for mixing operator O_{\gamma_5} at source and sink         #
#        - Read c2pt data files in h5 format mixing operator O_{id} at source and sink                   #
#        - Bootstrap the c2pt mixing_probe_src_oet_gf data                                               #
#                                                                                                        #
#   * Bootstrap flavor-conserving c2pt data for keys "f1-[...]-f1-[...]"                                 #
#        - Read c2pt data files in h5 format for mixing operator O_{\gamma_5} at source and sink         #
#        - Read c2pt data files in h5 format mixing operator O_{id} at source and sink                   #
#        - Bootstrap the c2pt mixing_probe_src_oet_gf data                                               #
#                                                                                                        #
#--------------------------------------------------------------------------------------------------------#
#                                                                                                        #
#   * Bootstrap flavor-changing c2pt data for keys "f0-[...]-f1-[...]"                                   #
#        - Read c2pt data files in h5 format for mixing operator O_{\gamma_5} at source and sink         #
#        - Read c2pt data files in h5 format mixing operator O_{id} at source and sink                   #
#        - Bootstrap the c2pt mixing_probe_src_oet_gf data                                               #
#                                                                                                        #
#   * Bootstrap flavor-changing c3pt data for keys "f0-[...]-f1-[...]"                                   #
#        - Read the c3pt data files in h5 format for mixing operator O_{\gamma_5} at source              #
#        - Read the c3pt data files in h5 format for mixing operator O_{id} at source                    #
#        - Bootstrap the c3pt mixing_probe_src_oet_gf data                                               #
#                                                                                                        #
#   * Bootstrap flavor-changing c2pt data for keys "f1-[...]-f0-[...]"                                   #
#        - Read c2pt data files in h5 format for mixing operator O_{\gamma_5} at source and sink         #
#        - Read c2pt data files in h5 format mixing operator O_{id} at source and sink                   #
#        - Bootstrap the c2pt mixing_probe_src_oet_gf data                                               #
#                                                                                                        #
#   * Bootstrap flavor-changing c3pt data for keys "f1-[...]-f0-[...]"                                   #
#        - Read the c3pt data files in h5 format for mixing operator O_{\gamma_5} at source              #
#        - Read the c3pt data files in h5 format for mixing operator O_{id} at source                    #
#        - Bootstrap the c3pt mixing_probe_src_oet_gf data                                               #
#                                                                                                        #
#--------------------------------------------------------------------------------------------------------#
#                                                                                                        #
#   * Bootstrap the flavor-changing cf ratios                                                            #
#        - Bootstrap the cf ratios for keys "f0-[...]-f1-[...]"                                          #
#        - Bootstrap the cf ratios for keys "f1-[...]-f0-[...]"                                          #
#                                                                                                        #
#========================================================================================================#
my_path <- "/home/nikolas/Documents/NPV/njjn_analysis/GRADIENT_FLOW/mixing_probe_src_oet_GRADFLOW/GRADFLOW_DATA/02_qbig_data_notimedilution_NLoopsamples1_part1and2"
my_T <- 64
my_gft <- c(0.00,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.10,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.20)

my_confs_part1 <- seq(from=0, to=2248, by=4)
my_confs_part2 <- seq(from=2, to=2250, by=4)
my_confs <- c(my_confs_part1, my_confs_part2)

my_src_timeslice_part1 <- c( 22,63,3,7,29,10,40,6,35,19,49,52,
                             23,52,21,22,16,40,19,12,0,5,27,2,
                             26,38,61,12,55,15,42,29,58,35,60,52,
                             6,11,48,35,31,46,42,54,18,37,61,10,
                             62,61,48,57,48,3,20,49,54,63,28,45,
                             55,6,44,42,56,31,27,5,41,31,13,42,
                             4,63,3,40,24,29,47,21,8,43,3,49,
                             17,52,20,25,43,8,49,51,12,31,14,25,
                             54,59,21,60,45,50,51,51,20,11,14,24,
                             3,35,39,0,60,49,30,30,19,39,29,56,
                             22,53,31,1,44,50,21,45,47,20,13,8,
                             30,40,37,52,59,5,46,38,34,25,5,46,
                             21,47,37,42,5,4,33,50,33,47,42,49,
                             17,25,27,44,63,60,29,20,46,57,59,10,
                             11,59,35,8,53,40,47,26,52,16,6,9,
                             7,29,28,52,46,26,16,44,9,34,54,11,
                             18,49,59,13,22,4,57,60,34,30,25,61,
                             28,62,56,7,58,41,10,51,1,40,2,52,
                             45,41,53,9,40,54,60,39,52,20,38,56,
                             25,17,26,19,57,8,37,5,3,8,44,48,
                             55,39,14,52,36,38,20,32,62,1,52,36,
                             45,16,25,43,4,57,24,23,31,23,26,51,
                             26,41,47,46,10,8,0,11,23,37,22,27,
                             1,44,25,61,62,15,33,28,32,4,56,23,
                             42,3,55,47,7,4,13,32,13,13,58,35,
                             52,34,33,11,3,23,23,41,1,47,1,36,
                             2,63,38,6,58,7,5,60,46,42,14,44,
                             34,12,36,26,21,35,9,7,59,4,28,60,
                             35,1,38,7,24,10,56,46,62,13,40,33,
                             12,6,60,43,18,26,10,23,28,17,40,56,
                             49,50,8,32,54,0,28,62,41,45,23,33,
                             22,33,2,42,44,26,35,1,61,28,36,44,
                             4,15,1,12,38,20,48,32,43,62,17,24,
                             28,19,63,1,30,12,1,23,33,56,10,18,
                             24,46,57,57,31,19,48,11,45,63,11,7,
                             43,27,10,22,32,42,44,57,23,37,40,39,
                             58,19,6,4,14,30,15,53,53,14,5,10,
                             6,27,37,15,10,61,45,55,3,56,54,26,
                             45,18,17,0,3,36,35,10,8,51,58,3,
                             28,43,1,47,13,38,29,18,16,5,11,39,
                             3,49,1,42,19,33,39,29,56,63,55,30,
                             40,48,35,52,5,11,53,53,49,54,13,57,
                             29,44,19,28,22,55,28,24,60,23,2,23,
                             52,15,63,3,47,2,44,43,12,50,56,1,
                             2,12,55,41,14,38,51,50,28,29,5,14,
                             1,49,44,39,1,45,38,38,13,23,52,30,
                             17,2,58,49,24,4,44,7,20,17,45 )

my_src_timeslice_part2 <- c( 55,48,25,17,14,47,39,46,18,44,21,62,
                             61,37,38,13,41,8,1,27,56,13,57,58,
                             52,61,55,45,25,44,48,26,53,62,2,49,
                             2,55,16,57,42,22,42,26,53,60,37,19,
                             29,50,5,31,44,16,32,52,52,26,51,63,
                             12,12,41,4,39,25,3,7,7,25,48,13,
                             39,8,42,2,6,48,59,36,3,17,42,20,
                             9,13,13,41,29,52,58,60,34,7,4,40,
                             62,37,22,26,38,10,36,43,60,15,16,21,
                             23,19,11,56,56,29,5,63,25,43,36,61,
                             11,54,63,57,24,47,41,52,39,11,36,29,
                             0,53,61,11,27,34,27,53,60,37,54,31,
                             5,19,22,13,33,51,4,4,16,41,32,49,
                             47,41,46,2,3,24,34,22,63,32,59,45,
                             0,24,43,30,1,27,2,50,37,28,37,49,
                             28,52,19,38,62,19,15,36,60,55,47,33,
                             8,41,47,0,27,52,56,61,44,38,11,3,
                             54,12,48,57,48,3,20,49,54,63,28,45,
                             55,6,44,42,56,31,27,5,41,31,13,42,
                             4,63,3,40,24,29,47,21,8,43,3,49,
                             17,52,20,25,43,8,49,51,12,31,14,25,
                             54,59,21,60,45,50,51,51,20,11,14,24,
                             3,35,39,0,60,49,30,30,19,39,29,56,
                             22,53,31,1,44,50,21,45,47,20,13,8,
                             30,40,37,52,59,5,46,38,34,25,5,46,
                             21,47,37,42,5,4,17,5,25,40,56,39,
                             11,11,50,13,12,42,27,9,12,26,0,49,
                             10,46,60,43,37,52,56,34,62,14,23,59,
                             43,61,16,48,0,28,22,56,3,2,8,10,
                             15,19,22,12,1,42,56,43,53,25,4,27,
                             46,23,3,7,46,11,21,48,63,2,50,7,
                             12,27,7,48,42,58,60,6,61,7,39,25,
                             34,43,49,7,55,48,54,63,51,45,47,48,
                             14,63,51,15,46,49,54,53,40,55,41,23,
                             0,7,30,7,40,10,42,49,31,62,5,5,
                             16,30,28,59,44,2,6,48,55,23,28,15,
                             7,44,49,29,27,10,25,56,46,46,55,57,
                             8,59,55,32,31,18,40,48,43,54,30,10,
                             54,6,26,35,0,56,18,12,13,38,36,9,
                             8,63,53,35,48,45,38,34,47,56,15,28,
                             52,47,9,9,1,33,0,11,63,12,53,39,
                             30,2,51,61,35,51,11,37,39,21,16,55,
                             18,36,62,6,16,44,3,34,13,48,43,44,
                             36,52,54,20,33,8,42,17,10,32,30,18,
                             0,27,62,36,14,1,53,36,41,14,35,57,
                             25,62,62,22,40,45,61,56,3,1,62,9,
                             37,35,54,47,38,3,61,33,18,6,43 )

my_src_timeslice <- c( my_src_timeslice_part1, my_src_timeslice_part2 )

my_iconflist_key_with_isample <- seq( 251, length(my_confs), 1 )

# my_isample_list <- c(NULL)
# my_isample_list <- c(0)

#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
#                                                                                                        #
#   Bootstrap flavor-conserving c2pt data for keys "f0-[...]-f0-[...]"                                   #
#                                                                                                        #
#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
print("Bootstrap flavor-conserving c2pt data for keys 'f0-[...]-f0-[...]'")

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read c2pt data files in h5 format for mixing operator O_{\gamma_5} at source and sink                #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xmx_g5_uu <- c2pt_read_h5_mx_oet_gradflow( path=my_path,
                                           outfile_prefix="mx_prb_src_oet",
                                           T=my_T,
                                           h5i_group="mx",
                                           conflist=my_confs,
                                           src_ts_list=my_src_timeslice,
                                           isample_list=NULL,
                                           flavor_1="up",
                                           gamma_mix="g5",
                                           flavor_2="up",
                                           px=0, py=0, pz=0,
                                           gradflow_t=my_gft )

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read c2pt data files in h5 format mixing operator O_{id} at source and sink                          #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xmx_id_uu <- c2pt_read_h5_mx_oet_gradflow( path=my_path,
                                           outfile_prefix="mx_prb_src_oet",
                                           T=my_T,
                                           h5i_group="mx",
                                           conflist=my_confs,
                                           src_ts_list=my_src_timeslice,
                                           isample_list=NULL,
                                           flavor_1="up",
                                           gamma_mix="id",
                                           flavor_2="up",
                                           px=0, py=0, pz=0,
                                           gradflow_t=my_gft )

Xmx_id_uu_mulmin1 <- (-1)*Xmx_id_uu

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Bootstrap the c2pt mixing_probe_src_oet_gf data                                                      #
#                                                                                                        #
#      * NOTE: c2pt_mx_gamma5_uu_cf_boot[[i]],                                                           #
#              c2pt_mx_id_uu_cf_boot[[i]] and                                                            #
#              c2pt_mx_id_uu_mulmin1_cf_boot[[i]]                                                        #
#                                                                                                        #
#        contain the shifted but raw, i.e. unsymmetrized cf data                                         #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
c2pt_mx_gamma5_uu_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_g5_uu,
                                                              gradflow_t=my_gft,
                                                              boot.R=boot.R,
                                                              boot.l=boot.l,
                                                              seed=seed )

#c2pt_mx_id_uu_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_id_uu,
#                                                          gradflow_t=my_gft,
#                                                          boot.R=boot.R,
#                                                          boot.l=boot.l,
#                                                          seed=seed )

c2pt_mx_id_uu_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_id_uu_mulmin1,
                                                                  gradflow_t=my_gft,
                                                                  boot.R=boot.R,
                                                                  boot.l=boot.l,
                                                                  seed=seed )

for ( i in 1:length(my_gft) ) {

  c2pt_mx_gamma5_uu_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c2pt_mx_gamma5_uu_cf_boot[[i]] )
  #c2pt_mx_id_uu_cf_boot[[i]]        <- hadron::symmetrise.cf( cf=c2pt_mx_id_uu_cf_boot[[i]] )
  c2pt_mx_id_uu_mulmin1_cf_boot[[i]] <- hadron::symmetrise.cf( cf=c2pt_mx_id_uu_mulmin1_cf_boot[[i]] )

}

##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##

#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
#                                                                                                        #
#   Bootstrap flavor-conserving c2pt data for keys "f1-[...]-f1-[...]"                                   #
#                                                                                                        #
#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
print("Bootstrap flavor-conserving c2pt data for keys 'f1-[...]-f1-[...]'")

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read c2pt data files in h5 format for mixing operator O_{\gamma_5} at source and sink                #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xmx_g5_dd <- c2pt_read_h5_mx_oet_gradflow( path=my_path,
                                           outfile_prefix="mx_prb_src_oet",
                                           T=my_T,
                                           h5i_group="mx",
                                           conflist=my_confs,
                                           src_ts_list=my_src_timeslice,
                                           isample_list=NULL,
                                           flavor_1="down",
                                           gamma_mix="g5",
                                           flavor_2="down",
                                           px=0, py=0, pz=0,
                                           gradflow_t=my_gft )

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read c2pt data files in h5 format mixing operator O_{id} at source and sink                          #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xmx_id_dd <- c2pt_read_h5_mx_oet_gradflow( path=my_path,
                                           outfile_prefix="mx_prb_src_oet",
                                           T=my_T,
                                           h5i_group="mx",
                                           conflist=my_confs,
                                           src_ts_list=my_src_timeslice,
                                           isample_list=NULL,
                                           flavor_1="down",
                                           gamma_mix="id",
                                           flavor_2="down",
                                           px=0, py=0, pz=0,
                                           gradflow_t=my_gft )

Xmx_id_dd_mulmin1 <- (-1)*Xmx_id_dd

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Bootstrap the c2pt mixing_probe_src_oet_gf data                                                      #
#                                                                                                        #
#      * NOTE: c2pt_mx_gamma5_dd_cf_boot[[i]],                                                           #
#              c2pt_mx_id_dd_cf_boot[[i]] and                                                            #
#              c2pt_mx_id_dd_mulmin1_cf_boot[[i]]                                                        #
#                                                                                                        #
#        contain the shifted but raw, i.e. unsymmetrized cf data                                         #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
c2pt_mx_gamma5_dd_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_g5_dd,
                                                              gradflow_t=my_gft,
                                                              boot.R=boot.R,
                                                              boot.l=boot.l,
                                                              seed=seed )

#c2pt_mx_id_dd_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_id_dd,
#                                                          gradflow_t=my_gft,
#                                                          boot.R=boot.R,
#                                                          boot.l=boot.l,
#                                                          seed=seed )

c2pt_mx_id_dd_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_id_dd_mulmin1,
                                                                  gradflow_t=my_gft,
                                                                  boot.R=boot.R,
                                                                  boot.l=boot.l,
                                                                  seed=seed )

for ( i in 1:length(my_gft) ) {

  c2pt_mx_gamma5_dd_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c2pt_mx_gamma5_dd_cf_boot[[i]] )
  #c2pt_mx_id_dd_cf_boot[[i]]        <- hadron::symmetrise.cf( cf=c2pt_mx_id_dd_cf_boot[[i]] )
  c2pt_mx_id_dd_mulmin1_cf_boot[[i]] <- hadron::symmetrise.cf( cf=c2pt_mx_id_dd_mulmin1_cf_boot[[i]] )

}

##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##

#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
#                                                                                                        #
#   Bootstrap flavor-changing c2pt data for keys "f0-[...]-f1-[...]"                                     #
#                                                                                                        #
#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
print("Bootstrap flavor-changing c2pt data for keys 'f0-[...]-f1-[...]'")

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read c2pt data files in h5 format for mixing operator O_{\gamma_5} at source and sink                #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xmx_g5_ud <- c2pt_read_h5_mx_oet_gradflow( path=my_path,
                                           outfile_prefix="mx_prb_src_oet",
                                           T=my_T,
                                           h5i_group="mx",
                                           conflist=my_confs,
                                           src_ts_list=my_src_timeslice,
                                           isample_list=NULL,
                                           flavor_1="up",
                                           gamma_mix="g5",
                                           flavor_2="down",
                                           px=0, py=0, pz=0,
                                           gradflow_t=my_gft )

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read c2pt data files in h5 format mixing operator O_{id} at source and sink                          #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xmx_id_ud <- c2pt_read_h5_mx_oet_gradflow( path=my_path,
                                           outfile_prefix="mx_prb_src_oet",
                                           T=my_T,
                                           h5i_group="mx",
                                           conflist=my_confs,
                                           src_ts_list=my_src_timeslice,
                                           isample_list=NULL,
                                           flavor_1="up",
                                           gamma_mix="id",
                                           flavor_2="down",
                                           px=0, py=0, pz=0,
                                           gradflow_t=my_gft )

Xmx_id_ud_mulmin1 <- (-1)*Xmx_id_ud

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Bootstrap the c2pt mixing_probe_src_oet_gf data                                                      #
#                                                                                                        #
#      * NOTE: c2pt_mx_gamma5_ud_cf_boot[[i]],                                                           #
#              c2pt_mx_id_ud_cf_boot[[i]] and                                                            #
#              c2pt_mx_id_ud_mulmin1_cf_boot[[i]]                                                        #
#                                                                                                        #
#        contain the shifted but raw, i.e. unsymmetrized cf data                                         #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
c2pt_mx_gamma5_ud_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_g5_ud,
                                                              gradflow_t=my_gft,
                                                              boot.R=boot.R,
                                                              boot.l=boot.l,
                                                              seed=seed )

#c2pt_mx_id_ud_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_id_ud,
#                                                          gradflow_t=my_gft,
#                                                          boot.R=boot.R,
#                                                          boot.l=boot.l,
#                                                          seed=seed )

c2pt_mx_id_ud_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_id_ud_mulmin1,
                                                                  gradflow_t=my_gft,
                                                                  boot.R=boot.R,
                                                                  boot.l=boot.l,
                                                                  seed=seed )

for ( i in 1:length(my_gft) ) {

  c2pt_mx_gamma5_ud_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c2pt_mx_gamma5_ud_cf_boot[[i]] )
  #c2pt_mx_id_ud_cf_boot[[i]]        <- hadron::symmetrise.cf( cf=c2pt_mx_id_ud_cf_boot[[i]] )
  c2pt_mx_id_ud_mulmin1_cf_boot[[i]] <- hadron::symmetrise.cf( cf=c2pt_mx_id_ud_mulmin1_cf_boot[[i]] )

}

#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
#                                                                                                        #
#   Bootstrap flavor-changing c3pt data for keys "f0-[...]-f1-[...]"                                     #
#                                                                                                        #
#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
print("Bootstrap flavor-changing c3pt data for keys 'f0-[...]-f1-[...]'")

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read the c3pt data files in h5 format for mixing operator O_{\gamma_5} at source                     #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xqb_D_vv_g5_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="down",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xcc_D_vv_g5_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="cc",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="down",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_B_vv_g5_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="down",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xcc_B_vv_g5_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="cc",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="down",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_D_aa_g5_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="aa",
                                                        flavor_2="down",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_B_aa_g5_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="aa",
                                                        flavor_2="down",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read the c3pt data files in h5 format for mixing operator O_{id} at source                           #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xqb_D_vv_id_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="down",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xcc_D_vv_id_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="cc",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="down",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_B_vv_id_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="down",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xcc_B_vv_id_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="cc",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="down",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_D_aa_id_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="aa",
                                                        flavor_2="down",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_B_aa_id_ud <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="up",
                                                        gamma_tag_4q="aa",
                                                        flavor_2="down",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

#========================================================================================================#
#                                                                                                        #
#    C_{3pt,mix}^{\gamma_5} = < O_{4q,X}(x_f) O_{\gamma_5}(x_i) >,   X= =1,2,3 ...                       #
#                                                                                                        #
#========================================================================================================#

## ... with O_1 = O_{vv}^{qb} = \qbar_a \gamma_\mu 1 q_a \qbar_b \gamma^\mu \tau^3 q_b
X1g5_ud <- 2*Xqb_D_vv_g5_ud - 2*Xqb_B_vv_g5_ud

## ... with O_2 = O_{vv}^{cc} = \qbar_a \gamma_\mu 1 q_b \qbar_b \gamma^\mu \tau^3 q_a
X2g5_ud <- 2*Xcc_D_vv_g5_ud - 2*Xcc_B_vv_g5_ud

## ... with O_3 = O_{aa}^{qb} = \qbar_a \gamma_\mu \gamma_5 1 q_a \qbar_b \gamma^\mu \gamma_5 \tau^3 q_b 
X3g5_ud <- 2*Xqb_D_aa_g5_ud - 2*Xqb_B_aa_g5_ud
X3g5_ud_mulmin1 <- (-1)*(2*Xqb_D_aa_g5_ud - 2*Xqb_B_aa_g5_ud)

#========================================================================================================#
#                                                                                                        #
#    C_{3pt,mix}^{id} = < O_{4q,Y}(x_f) O_{id}(x_i) >,   X=1,2,3 ...                                     #
#                                                                                                        #
#========================================================================================================#

## ... with O_1 = O_{vv}^{qb} = \qbar_a \gamma_\mu 1 q_a \qbar_b \gamma^\mu \tau^3 q_b
X1id_ud <- 2*Xqb_D_vv_id_ud - 2*Xqb_B_vv_id_ud
X1id_ud_mulmin1 <- (-1)*(2*Xqb_D_vv_id_ud - 2*Xqb_B_vv_id_ud)

## ... with O_2 = O_{vv}^{cc} = \qbar_a \gamma_\mu 1 q_b \qbar_b \gamma^\mu \tau^3 q_a
X2id_ud <- 2*Xcc_D_vv_id_ud - 2*Xcc_B_vv_id_ud
X2id_ud_mulmin1 <- (-1)*(2*Xcc_D_vv_id_ud - 2*Xcc_B_vv_id_ud)

## ... with O_3 = O_{aa}^{qb} = \qbar_a \gamma_\mu \gamma_5 1 q_a \qbar_b \gamma^\mu \gamma_5 \tau^3 q_b 
X3id_ud <- 2*Xqb_D_aa_id_ud - 2*Xqb_B_aa_id_ud
X3id_ud_mulmin1 <- (-1)*(2*Xqb_D_aa_id_ud - 2*Xqb_B_aa_id_ud)

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Bootstrap the c3pt mixing_probe_src_oet_gf data                                                      #
#                                                                                                        #
#      * NOTE: c3pt_mx_vvqb_gamma5_ud_cf_boot[[i]],                                                      #
#              c3pt_mx_vvcc_gamma5_ud_cf_boot[[i]],                                                      #
#              c3pt_mx_aaqb_gamma5_ud_cf_boot[[i]],                                                      #
#              c3pt_mx_aaqb_gamma5_ud_mulmin1_cf_boot[[i]],                                              #
#              c3pt_mx_vvqb_id_ud_cf_boot[[i]],                                                          #
#              c3pt_mx_vvqb_id_ud_mulmin1_cf_boot[[i]],                                                  #
#              c3pt_mx_vvcc_id_ud_cf_boot[[i]],                                                          #
#              c3pt_mx_vvcc_id_ud_mulmin1_cf_boot[[i]] and                                               #
#              c3pt_mx_aaqb_id_ud_cf_boot[[i]]                                                           #
#                                                                                                        #
#        contain the shifted but raw, i.e. unsymmetrized cf data                                         #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
c3pt_mx_vvqb_gamma5_ud_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X1g5_ud,
                                                                   gradflow_t=my_gft,
                                                                   boot.R=boot.R,
                                                                   boot.l=boot.l,
                                                                   seed=seed )

c3pt_mx_vvcc_gamma5_ud_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X2g5_ud,
                                                                   gradflow_t=my_gft,
                                                                   boot.R=boot.R,
                                                                   boot.l=boot.l,
                                                                   seed=seed )

c3pt_mx_aaqb_gamma5_ud_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X3g5_ud,
                                                                   gradflow_t=my_gft,
                                                                   boot.R=boot.R,
                                                                   boot.l=boot.l,
                                                                   seed=seed )

c3pt_mx_aaqb_gamma5_ud_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X3g5_ud_mulmin1,
                                                                           gradflow_t=my_gft,
                                                                           boot.R=boot.R,
                                                                           boot.l=boot.l,
                                                                           seed=seed )

c3pt_mx_vvqb_id_ud_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X1id_ud,
                                                               gradflow_t=my_gft,
                                                               boot.R=boot.R,
                                                               boot.l=boot.l,
                                                               seed=seed )

c3pt_mx_vvqb_id_ud_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X1id_ud_mulmin1,
                                                                       gradflow_t=my_gft,
                                                                       boot.R=boot.R,
                                                                       boot.l=boot.l,
                                                                       seed=seed )

c3pt_mx_vvcc_id_ud_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X2id_ud,
                                                               gradflow_t=my_gft,
                                                               boot.R=boot.R,
                                                               boot.l=boot.l,
                                                               seed=seed )

c3pt_mx_vvcc_id_ud_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X2id_ud_mulmin1,
                                                                       gradflow_t=my_gft,
                                                                       boot.R=boot.R,
                                                                       boot.l=boot.l,
                                                                       seed=seed )

c3pt_mx_aaqb_id_ud_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X3id_ud,
                                                               gradflow_t=my_gft,
                                                               boot.R=boot.R,
                                                               boot.l=boot.l,
                                                               seed=seed )

c3pt_mx_aaqb_id_ud_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X3id_ud_mulmin1,
                                                                       gradflow_t=my_gft,
                                                                       boot.R=boot.R,
                                                                       boot.l=boot.l,
                                                                       seed=seed )

for ( i in 1:length(my_gft) ) {

  c3pt_mx_vvqb_gamma5_ud_cf_boot[[i]]         <- hadron::symmetrise.cf( cf=c3pt_mx_vvqb_gamma5_ud_cf_boot[[i]] )
  c3pt_mx_vvcc_gamma5_ud_cf_boot[[i]]         <- hadron::symmetrise.cf( cf=c3pt_mx_vvcc_gamma5_ud_cf_boot[[i]] )
  c3pt_mx_aaqb_gamma5_ud_cf_boot[[i]]         <- hadron::symmetrise.cf( cf=c3pt_mx_aaqb_gamma5_ud_cf_boot[[i]] )
  c3pt_mx_aaqb_gamma5_ud_mulmin1_cf_boot[[i]] <- hadron::symmetrise.cf( cf=c3pt_mx_aaqb_gamma5_ud_mulmin1_cf_boot[[i]] )
  c3pt_mx_vvqb_id_ud_cf_boot[[i]]             <- hadron::symmetrise.cf( cf=c3pt_mx_vvqb_id_ud_cf_boot[[i]] )
  c3pt_mx_vvqb_id_ud_mulmin1_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c3pt_mx_vvqb_id_ud_mulmin1_cf_boot[[i]] )
  c3pt_mx_vvcc_id_ud_cf_boot[[i]]             <- hadron::symmetrise.cf( cf=c3pt_mx_vvcc_id_ud_cf_boot[[i]] )
  c3pt_mx_vvcc_id_ud_mulmin1_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c3pt_mx_vvcc_id_ud_mulmin1_cf_boot[[i]] )
  c3pt_mx_aaqb_id_ud_cf_boot[[i]]             <- hadron::symmetrise.cf( cf=c3pt_mx_aaqb_id_ud_cf_boot[[i]] )
  c3pt_mx_aaqb_id_ud_mulmin1_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c3pt_mx_aaqb_id_ud_mulmin1_cf_boot[[i]] )
}


##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##


#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
#                                                                                                        #
#   Bootstrap flavor-changing c2pt data for keys "f1-[...]-f0-[...]"                                     #
#                                                                                                        #
#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
print("Bootstrap flavor-changing c2pt data for keys 'f1-[...]-f0-[...]'")

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read c2pt data files in h5 format for mixing operator O_{\gamma_5} at source and sink                #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xmx_g5_du <- c2pt_read_h5_mx_oet_gradflow( path=my_path,
                                           outfile_prefix="mx_prb_src_oet",
                                           T=my_T,
                                           h5i_group="mx",
                                           conflist=my_confs,
                                           src_ts_list=my_src_timeslice,
                                           isample_list=NULL,
                                           flavor_1="down",
                                           gamma_mix="g5",
                                           flavor_2="up",
                                           px=0, py=0, pz=0,
                                           gradflow_t=my_gft )

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read c2pt data files in h5 format mixing operator O_{id} at source and sink                          #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xmx_id_du <- c2pt_read_h5_mx_oet_gradflow( path=my_path,
                                           outfile_prefix="mx_prb_src_oet",
                                           T=my_T,
                                           h5i_group="mx",
                                           conflist=my_confs,
                                           src_ts_list=my_src_timeslice,
                                           isample_list=NULL,
                                           flavor_1="down",
                                           gamma_mix="id",
                                           flavor_2="up",
                                           px=0, py=0, pz=0,
                                           gradflow_t=my_gft )

Xmx_id_du_mulmin1 <- (-1)*Xmx_id_du

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Bootstrap the c2pt mixing_probe_src_oet_gf data                                                      #
#                                                                                                        #
#      * NOTE: c2pt_mx_gamma5_du_cf_boot[[i]],                                                           #
#              c2pt_mx_id_du_cf_boot[[i]] and                                                            #
#              c2pt_mx_id_du_mulmin1_cf_boot[[i]]                                                        #
#                                                                                                        #
#        contain the shifted but raw, i.e. unsymmetrized cf data                                         #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
c2pt_mx_gamma5_du_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_g5_du,
                                                              gradflow_t=my_gft,
                                                              boot.R=boot.R,
                                                              boot.l=boot.l,
                                                              seed=seed )

#c2pt_mx_id_du_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_id_du,
#                                                          gradflow_t=my_gft,
#                                                          boot.R=boot.R,
#                                                          boot.l=boot.l,
#                                                          seed=seed )

c2pt_mx_id_du_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=Xmx_id_du_mulmin1,
                                                                  gradflow_t=my_gft,
                                                                  boot.R=boot.R,
                                                                  boot.l=boot.l,
                                                                  seed=seed )

for ( i in 1:length(my_gft) ) {

  c2pt_mx_gamma5_du_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c2pt_mx_gamma5_du_cf_boot[[i]] )
  #c2pt_mx_id_du_cf_boot[[i]]        <- hadron::symmetrise.cf( cf=c2pt_mx_id_du_cf_boot[[i]] )
  c2pt_mx_id_du_mulmin1_cf_boot[[i]] <- hadron::symmetrise.cf( cf=c2pt_mx_id_du_mulmin1_cf_boot[[i]] )

}

#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
#                                                                                                        #
#   Bootstrap flavor-changing c3pt data for keys "f1-[...]-f0-[...]"                                     #
#                                                                                                        #
#========================================================================================================#
#========================================================================================================#
#========================================================================================================#
print("Bootstrap flavor-changing c3pt data for keys 'f1-[...]-f0-[...]'")

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read the c3pt data files in h5 format for mixing operator O_{\gamma_5} at source                     #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xqb_D_vv_g5_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="up",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xcc_D_vv_g5_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="cc",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="up",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_B_vv_g5_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="up",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xcc_B_vv_g5_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="cc",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="up",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_D_aa_g5_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="aa",
                                                        flavor_2="up",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_B_aa_g5_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="aa",
                                                        flavor_2="up",
                                                        gamma_mix="g5",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Read the c3pt data files in h5 format for mixing operator O_{id} at source                           #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
Xqb_D_vv_id_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="up",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xcc_D_vv_id_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="cc",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="up",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_B_vv_id_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="up",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xcc_B_vv_id_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="cc",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="vv",
                                                        flavor_2="up",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_D_aa_id_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="d",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="aa",
                                                        flavor_2="up",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

Xqb_B_aa_id_du <- c3pt_read_h5_mx_prb_src_oet_gradflow_onesample_mixedkeys( path=my_path,
                                                        outfile_prefix="mx_prb_src_oet",
                                                        T=my_T,
                                                        diagram_type="b",
                                                        h5i_group="qb",
                                                        conflist=my_confs,
                                                        src_ts_list=my_src_timeslice,
                                                        iconflist_key_with_isample=my_iconflist_key_with_isample,
                                                        flavor_1="down",
                                                        gamma_tag_4q="aa",
                                                        flavor_2="up",
                                                        gamma_mix="id",
                                                        px=0, py=0, pz=0,
                                                        gradflow_t=my_gft,
                                                        average=FALSE )

#========================================================================================================#
#                                                                                                        #
#    C_{3pt,mix}^{\gamma_5} = < O_{4q,X}(x_f) O_{\gamma_5}(x_i) >,   X= =1,2,3 ...                       #
#                                                                                                        #
#========================================================================================================#

## ... with O_1 = O_{vv}^{qb} = \qbar_a \gamma_\mu 1 q_a \qbar_b \gamma^\mu \tau^3 q_b
X1g5_du <- 2*Xqb_D_vv_g5_du - 2*Xqb_B_vv_g5_du

## ... with O_2 = O_{vv}^{cc} = \qbar_a \gamma_\mu 1 q_b \qbar_b \gamma^\mu \tau^3 q_a
X2g5_du <- 2*Xcc_D_vv_g5_du - 2*Xcc_B_vv_g5_du

## ... with O_3 = O_{aa}^{qb} = \qbar_a \gamma_\mu \gamma_5 1 q_a \qbar_b \gamma^\mu \gamma_5 \tau^3 q_b 
X3g5_du <- 2*Xqb_D_aa_g5_du - 2*Xqb_B_aa_g5_du
X3g5_du_mulmin1 <- (-1)*(2*Xqb_D_aa_g5_du - 2*Xqb_B_aa_g5_du)

#========================================================================================================#
#                                                                                                        #
#    C_{3pt,mix}^{id} = < O_{4q,Y}(x_f) O_{id}(x_i) >,   X=1,2,3 ...                                     #
#                                                                                                        #
#========================================================================================================#

## ... with O_1 = O_{vv}^{qb} = \qbar_a \gamma_\mu 1 q_a \qbar_b \gamma^\mu \tau^3 q_b
X1id_du <- 2*Xqb_D_vv_id_du - 2*Xqb_B_vv_id_du
X1id_du_mulmin1 <- (-1)*(2*Xqb_D_vv_id_du - 2*Xqb_B_vv_id_du)

## ... with O_2 = O_{vv}^{cc} = \qbar_a \gamma_\mu 1 q_b \qbar_b \gamma^\mu \tau^3 q_a
X2id_du <- 2*Xcc_D_vv_id_du - 2*Xcc_B_vv_id_du
X2id_du_mulmin1 <- (-1)*(2*Xcc_D_vv_id_du - 2*Xcc_B_vv_id_du)

## ... with O_3 = O_{aa}^{qb} = \qbar_a \gamma_\mu \gamma_5 1 q_a \qbar_b \gamma^\mu \gamma_5 \tau^3 q_b 
X3id_du <- 2*Xqb_D_aa_id_du - 2*Xqb_B_aa_id_du
X3id_du_mulmin1 <- (-1)*(2*Xqb_D_aa_id_du - 2*Xqb_B_aa_id_du)

#========================================================================================================#
#--------------------------------------------------------------------------------------------------------#
#   Bootstrap the c3pt mixing_probe_src_oet_gf data                                                      #
#                                                                                                        #
#      * NOTE: c3pt_mx_vvqb_gamma5_du_cf_boot[[i]],                                                      #
#              c3pt_mx_vvcc_gamma5_du_cf_boot[[i]],                                                      #
#              c3pt_mx_aaqb_gamma5_du_cf_boot[[i]],                                                      #
#              c3pt_mx_aaqb_gamma5_du_mulmin1_cf_boot[[i]],                                              #
#              c3pt_mx_vvqb_id_du_cf_boot[[i]],                                                          #
#              c3pt_mx_vvqb_id_du_mulmin1_cf_boot[[i]],                                                  #
#              c3pt_mx_vvcc_id_du_cf_boot[[i]],                                                          #
#              c3pt_mx_vvcc_id_du_mulmin1_cf_boot[[i]] and                                               #
#              c3pt_mx_aaqb_id_du_cf_boot[[i]]                                                           #
#                                                                                                        #
#         contain the shifted but raw, i.e. unsymmetrized cf data                                        #
#--------------------------------------------------------------------------------------------------------#
#========================================================================================================#
c3pt_mx_vvqb_gamma5_du_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X1g5_du,
                                                                   gradflow_t=my_gft,
                                                                   boot.R=boot.R,
                                                                   boot.l=boot.l,
                                                                   seed=seed )

c3pt_mx_vvcc_gamma5_du_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X2g5_du,
                                                                   gradflow_t=my_gft,
                                                                   boot.R=boot.R,
                                                                   boot.l=boot.l,
                                                                   seed=seed )

c3pt_mx_aaqb_gamma5_du_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X3g5_du,
                                                                   gradflow_t=my_gft,
                                                                   boot.R=boot.R,
                                                                   boot.l=boot.l,
                                                                   seed=seed )

c3pt_mx_aaqb_gamma5_du_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X3g5_du_mulmin1,
                                                                           gradflow_t=my_gft,
                                                                           boot.R=boot.R,
                                                                           boot.l=boot.l,
                                                                           seed=seed )

c3pt_mx_vvqb_id_du_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X1id_du,
                                                               gradflow_t=my_gft,
                                                               boot.R=boot.R,
                                                               boot.l=boot.l,
                                                               seed=seed )

c3pt_mx_vvqb_id_du_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X1id_du_mulmin1,
                                                                       gradflow_t=my_gft,
                                                                       boot.R=boot.R,
                                                                       boot.l=boot.l,
                                                                       seed=seed )

c3pt_mx_vvcc_id_du_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X2id_du,
                                                               gradflow_t=my_gft,
                                                               boot.R=boot.R,
                                                               boot.l=boot.l,
                                                               seed=seed )

c3pt_mx_vvcc_id_du_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X2id_du_mulmin1,
                                                                       gradflow_t=my_gft,
                                                                       boot.R=boot.R,
                                                                       boot.l=boot.l,
                                                                       seed=seed )

c3pt_mx_aaqb_id_du_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X3id_du,
                                                               gradflow_t=my_gft,
                                                               boot.R=boot.R,
                                                               boot.l=boot.l,
                                                               seed=seed )

c3pt_mx_aaqb_id_du_mulmin1_cf_boot <- boot_cf_mixing_probe_src_oet_gf( x=X3id_du_mulmin1,
                                                                       gradflow_t=my_gft,
                                                                       boot.R=boot.R,
                                                                       boot.l=boot.l,
                                                                       seed=seed )

for ( i in 1:length(my_gft) ) {

  c3pt_mx_vvqb_gamma5_du_cf_boot[[i]]         <- hadron::symmetrise.cf( cf=c3pt_mx_vvqb_gamma5_du_cf_boot[[i]] )
  c3pt_mx_vvcc_gamma5_du_cf_boot[[i]]         <- hadron::symmetrise.cf( cf=c3pt_mx_vvcc_gamma5_du_cf_boot[[i]] )
  c3pt_mx_aaqb_gamma5_du_cf_boot[[i]]         <- hadron::symmetrise.cf( cf=c3pt_mx_aaqb_gamma5_du_cf_boot[[i]] )
  c3pt_mx_aaqb_gamma5_du_mulmin1_cf_boot[[i]] <- hadron::symmetrise.cf( cf=c3pt_mx_aaqb_gamma5_du_mulmin1_cf_boot[[i]] )
  c3pt_mx_vvqb_id_du_cf_boot[[i]]             <- hadron::symmetrise.cf( cf=c3pt_mx_vvqb_id_du_cf_boot[[i]] )
  c3pt_mx_vvqb_id_du_mulmin1_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c3pt_mx_vvqb_id_du_mulmin1_cf_boot[[i]] )
  c3pt_mx_vvcc_id_du_cf_boot[[i]]             <- hadron::symmetrise.cf( cf=c3pt_mx_vvcc_id_du_cf_boot[[i]] )
  c3pt_mx_vvcc_id_du_mulmin1_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c3pt_mx_vvcc_id_du_mulmin1_cf_boot[[i]] )
  c3pt_mx_aaqb_id_du_cf_boot[[i]]             <- hadron::symmetrise.cf( cf=c3pt_mx_aaqb_id_du_cf_boot[[i]] )
  c3pt_mx_aaqb_id_du_mulmin1_cf_boot[[i]]     <- hadron::symmetrise.cf( cf=c3pt_mx_aaqb_id_du_mulmin1_cf_boot[[i]] )
}

##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
print("Start saving the workspace image.")

#--------------------------------------------------------------------------------------------------------#
#   SAVE WORKSPACE IMAGE                                                                                 #
#--------------------------------------------------------------------------------------------------------#
save.image( file = paste0("bootstrap_cf_mx_prb_oet_gf_notimedilution_Nconfs", length(my_confs), "_Nsamples1_4qFlavorChange_part1.RData") )

#--------------------------------------------------------------------------------------------------------#
#   PRINT WORKSPACE IMAGE PATH TO FILE                                                                   #
#--------------------------------------------------------------------------------------------------------#
fileConn<-file(paste0("my_path_flavor_changing_Nconfs", length(my_confs), "_Nsamples1_part1.txt"))
writeLines(paste0("/home/nikolas/Documents/NPV/njjn_analysis/GRADIENT_FLOW/mixing_probe_src_oet_GRADFLOW/GRADFLOW_ANALYSIS/04_bootstrap_notimedilution_NLoopsamples8_symm/01_boot_cf_data/NLoopsamples_01/01_boot_cf_data_Nconfs563_4qFlavorChange/bootstrap_cf_mx_prb_oet_gf_notimedilution_Nconfs", length(my_confs), "_Nsamples1_4qFlavorChange_part1.RData"), fileConn)
close(fileConn)
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##
##==================================================================================================================================================================================================================================##